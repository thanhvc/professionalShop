<div class="calendar-filters-container">

    <select data-ng-model="filterOptions.filters.selectMonth" class="filter-calendar"  ng-change="goToMonth()"
            ng-options="(item.month | translate | uppercase ) +' '+item.year for item in filterOptions.months">
    </select>
    <select ng-if="!loadingFilters" data-ng-model="filterOptions.filters.selectedRegion" class="filter-calendar" ng-change="selectRegion();" ng-disabled="filterOptions.selectors.regions.length <= 0">
        <option selected value="">- {{'CALENDAR.region'|translate}} -</option>
        <option ng-repeat="region in filterOptions.selectors.regions | orderBy:['description']" ng-selected="{{region.id == filterOptions.filters.selectedRegion}}" value="{{region.id}}">
            {{('REGIONS.' + region.id) | translate}}
        </option>
    </select>
    <select class="filter-calendar" ng-if="loadingFilters"  disabled="true">
        <option value="">- {{ 'LOADING'|translate}} -</option>
    </select>
    <select ng-if="!loadingFilters" data-ng-model="filterOptions.filters.selectedMarket" class="filter-calendar"  ng-change="selectMarket();" ng-disabled="filterOptions.selectors.markets.length <= 0">
        <option selected value="">- {{'CALENDAR.market'|translate}} -</option>
        <option ng-repeat="market in filterOptions.selectors.markets | orderBy:['description']" ng-selected="{{market.id == filterOptions.filters.selectedMarket}}" value="{{market.id}}">{{market.description}}</option>
    </select>
    <select class="filter-calendar"ng-if="loadingFilters" disabled="true" >
        <option value="">- {{ 'LOADING'|translate}} -</option>
    </select>
    <select data-ng-model="filterOptions.filters.selectedOperation" class="filter-calendar"
            ng-options="item.description|translate for item in filterOptions.selectors.operations"
            ng-change="search();">
        <option selected value="">- {{'CALENDAR.operation'|translate}} -</option>
        <!--<option ng-repeat="operation in filterOptions.selectors.operations"
        value="{{operation.id}}">{{operation.description | translate}}</option>-->
    </select>
    <input type="checkbox" ng-model="filterOptions.filters.favourite" ng-change="search();"><label>{{'CALENDAR.favorites'|translate}}</label>
    <form name="calendarStock">
        <input  name="dayInput" placeholder="{{'CALENDAR.day'|translate}}" data-ng-model="filterOptions.filters.dayDateInput" ng-change="search();" ng-delay="3000"
               type="text" ng-class=" {'warning-input':  (calendarStock.dayInput.$error.pattern && (calendarStock.dayInput.$dirty))}"
               ng-pattern="dayPattern" ng-trim="false">
        <select data-ng-model="filterOptions.filters.order" class="filter-calendar select-order"  class="select-order" ng-change="orderSearch();" ng-delay="3000" >
            <option selected value="0">{{'CALENDAR.sort_entry'|translate}}</option>
            <option value="1">{{'CALENDAR.sort_exit'|translate}}</option>
        </select>
    </form>
</div>
<div class="loading-div no-patterns-container" ng-show="loading"><img src="assets/img/ajax-loader.gif" class="loading-gif"><span>{{'CALENDAR.loading_patterns'|translate}}</span></div>
<div class="no-patterns-container" ng-if="myData.length == 0 && !loading && appliedFilters"><span >{{'CALENDAR.no_patterns_with_condition'|translate}}</span></div>
<div class="no-patterns-container" ng-show="myData.length==0 && !loading && !appliedFilters">{{'CALENDAR.no_patterns_in_month'|translate}}</div>
<div ng-show="myData.length >0">
<table class="calendar-table">
    <thead>
    <tr>
        <th>{{'CALENDAR.name'|translate}}</th>
        <th ng-repeat="day in daysOfMonth" ng-class="{'weekend' : day.dayOfWeek == 'Sa' || day.dayOfWeek == 'Do'}">{{('CALENDAR.DAYS.'+day.dayOfWeek)|translate}}<br/>{{day.dayOfMonth}}</th>
    </tr>
    </thead>
    <tbody>
    <tr ng-repeat="pattern in myData">
        <td ui-sref="detail({patternId:pattern.id})">
            <div class="text-limitator-calendar" tooltip="{{pattern.asset.longName}} ({{pattern.asset.exchange.symbol}})">
            <span  class="cursor-help" ng-class="{'buy-color': pattern.patternType == 'BULLISH', 'sell-color': pattern.patternType == 'BEARISH'}">{{pattern.asset.longName }}</span>
            </div>
        </td>
        <td ng-repeat="day in daysOfMonth" ng-class="{'weekend' : day.dayOfWeek == 'Sa' || day.dayOfWeek == 'Do'}">
            <!--<span ng-show="pattern.patternType == 'BEARISH' && day.dayOfMonth >= filterOptions.filters.dayDateInput  && day.dayOfMonth >= {{pattern.entryDate | date: 'dd'}} && day.dayOfMonth <= {{pattern.exitDate | date: 'dd'}} && {{pattern.exitDate | date:'MM'}} == filterOptions.filters.month.month" class="bearish-year calendar-letter">S</span>
            <span ng-show="pattern.patternType == 'BULLISH' && day.dayOfMonth >= filterOptions.filters.dayDateInput && day.dayOfMonth >= {{pattern.entryDate | date: 'dd'}} && day.dayOfMonth <= {{pattern.exitDate | date: 'dd'}} && {{pattern.exitDate | date:'MM'}} == filterOptions.filters.month.month" class="bullish-year calendar-letter">L</span>

            <span ng-show="pattern.patternType == 'BEARISH' && day.dayOfMonth >= {{pattern.entryDate | date: 'dd'}} && {{pattern.exitDate | date:'MM'}} != filterOptions.filters.month.month" class="bearish-year calendar-letter">S</span>
            <span ng-show="pattern.patternType == 'BULLISH' && day.dayOfMonth >= {{pattern.entryDate | date: 'dd'}} && {{pattern.exitDate | date:'MM'}} != filterOptions.filters.month.month" class="bullish-year calendar-letter">L</span>
            -->
            <span ng-show="pattern.patternType == 'BEARISH' && mustPaint(day,pattern)" class="bearish-year calendar-letter">S</span>
            <span ng-show="pattern.patternType == 'BULLISH' && mustPaint(day,pattern)" class="bullish-year calendar-letter">L</span>


        </td>
    </tr>

    </tbody>


</table>
</div>
<div class="copyright">
    Copyright Â© {{actualDate | date: 'yyyy'}} Market Observatory
</div>
<!--pagination-->
<div class="pagination-container" style="margin-top:40px; clear:both;" ng-show="found > pagingOptions.pageSize">
    <pagination boundary-links="true" on-select-page="setPage(page)" total-items="found"
                items-per-page="pagingOptions.pageSize" max-size="pagingOptions.pageSize"
                page="pagingOptions.currentPage" class="pagination-sm" previous-text="&lt;"
                next-text="&gt;"
                first-text="&lt;&lt;" last-text="&gt;&gt;"></pagination>
</div>

<div class="calendar-caption">
    <span class="bullish-year calendar-letter">L: </span> Long ({{'CALENDAR.buyCaption'|translate}})
    <span style="margin-left: 14px;" class="bearish-year calendar-letter">S: </span> Short ({{'CALENDAR.sellCaption'|translate}})
</div>